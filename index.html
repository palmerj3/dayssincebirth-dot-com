<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Days Since Birth</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Easily calculate the number of days since you were born">
    <meta name="author" content="Jason Palmer">

    <link href="public/css/bootstrap.min.css" rel="stylesheet">
  </head>

  <body>
    <div class="container">

      <!-- Main hero unit for a primary marketing message or call to action -->
      <div class="hero-unit">
        <h1>Days Since Birth</h1>
        <p>Use this tool to quickly calculate how many days it's been since you were born.</p>
      </div>

      <div class="row">
        <div class="span4">
          <h4>Advertisement</h4>
        </div>

        <div class="span8">
          <div style="display: none" class="well" id="result-container">
            <h2 id="result"></h2>
          </div>

          <form class="form-horizontal">
            <fieldset>
              <legend>Enter Date of Birth Below</legend>
              <div class="control-group">
                <label class="control-label" for="dob">Date of Birth</label>
                <div class="controls">
                  <select name="dob-month" id="dob-month" class="span2">
                    <option value="00">Month..</option>
                    <option value="01">January</option>
                    <option value="02">February</option>
                    <option value="03">March</option>
                    <option value="04">April</option>
                    <option value="05">May</option>
                    <option value="06">June</option>
                    <option value="07">July</option>
                    <option value="08">August</option>
                    <option value="09">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                  </select>

                  <select name="dob-day" id="dob-day" class="span2">
                    <option value="00">Day..</option>
                    <option value="01">1</option>
                    <option value="02">2</option>
                    <option value="03">3</option>
                    <option value="04">4</option>
                    <option value="05">5</option>
                    <option value="06">6</option>
                    <option value="07">7</option>
                    <option value="08">8</option>
                    <option value="09">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                  </select>

                  <select name="dob-year" id="dob-year" class="span2">
                    <option value="00">Year..</option>
                  </select>
                  
                  <br />
                  <br />
                  <a id="more-link" href="#" style="padding: 4px;">More [+]</a>
                  <div id="more-container" class="well" style="display: none;">
                    <h4>Other Units of Measure</h4>
                    <ul class="form-inline unstyled">
                      <li><input type="checkbox" id="unit-weeks">&nbsp;<label for="unit-weeks">Weeks</label></li>
                      <li><input type="checkbox" id="unit-hours">&nbsp;<label for="unit-hours">Hours</label></li>
                      <li><input type="checkbox" id="unit-minutes">&nbsp;<label for="unit-minutes">Minutes</label></li>
                      <li><input type="checkbox" id="unit-seconds">&nbsp;<label for="unit-seconds">Seconds</label></li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="dob-submit">Submit</button>
                <button class="btn" id="dob-cancel">Cancel</button>
              </div>
            </fieldset>
          </form>

        </div>
      </div>

      <hr>

      <footer>
        <p>&copy; <a href="http://www.jason-palmer.com/" target="_blank">Jason Palmer</a> 2012</p>
      </footer>

    </div>

    <script type="text/javascript">
    (function (document) {
        'use strict';

        var yearField = document.getElementById('dob-year'),
            monthField = document.getElementById('dob-month'),
            dayField = document.getElementById('dob-day'),
            submitButton = document.getElementById('dob-submit'),
            cancelButton = document.getElementById('dob-cancel'),
            resultElement = document.getElementById('result'),
            resultContainer = document.getElementById('result-container'),
            moreLinkElement = document.getElementById('more-link'),
            moreContainerElement = document.getElementById('more-container'),
            currentYear = (new Date()).getFullYear(),
            todayUnixTime = Math.round((new Date()).getTime() / 1000),
            dob = new Date(),
            unitLabels = {
              'unit-weeks': {
                'relativity' : 604800,
                'label' : 'Weeks'
              },
              'unit-hours': {
                'relativity' : 3600,
                'label' : 'Hours'
              },
              'unit-minutes': {
                'relativity' : 60,
                'label' : 'Minutes'
              },
              'unit-seconds': {
                'relativity' : 1,
                'label' : 'Seconds'
              }
            },
            yearArray = [];

        // Set values for year field
        while (currentYear >= 1900) {
            yearArray.push('<option value="' + currentYear + '">' + currentYear + '</option>');
            currentYear -= 1;
        }
        yearField.innerHTML = yearField.innerHTML + yearArray.join('');

        // Attach click event to submit
        submitButton.addEventListener('click', function (e) {
            var results = [];
            e.preventDefault();

            try {
                // Build date object from entered DOB
                dob.setDate(parseInt(dayField.options[dayField.selectedIndex], 10).value);
                dob.setFullYear(parseInt(yearField.options[yearField.selectedIndex].value, 10));
                dob.setMonth(parseInt(monthField.options[monthField.selectedIndex].value, 10) - 1); // why JavaScript?
            } catch (err) {
                console.log(err);
            }

            // Push default unit
            results.push((Math.round((todayUnixTime - (Math.round(dob.getTime() / 1000))) / 86400)) + ' Days since you were born!');
            
            // Push additional units if requested
            for (var label in unitLabels) {
              if (unitLabels.hasOwnProperty(label)) {
                if (document.getElementById(label).checked === true) {
                  results.push((Math.round((todayUnixTime - (Math.round(dob.getTime() / 1000))) / unitLabels[label]['relativity'])) + ' ' + unitLabels[label]['label'] + ' since you were born!');
                }
              }
            }
            
            // Show results
            resultElement.innerHTML = results.join('<br />');
            resultContainer.style.display = 'block';
        }, false);

        // Attach click event to cancel
        cancelButton.addEventListener('click', function (e) {
            e.preventDefault();

            yearField.selectedIndex = 0;
            monthField.selectedIndex = 0;
            dayField.selectedIndex = 0;
        }, false);

        // Attach event to more link
        moreLinkElement.addEventListener('click', function (e) {
          var isVisible = moreContainerElement.style.display === 'block';
          e.preventDefault();
          
          if (isVisible === false) {
            moreContainerElement.style.display = 'block';
            moreLinkElement.innerHTML = 'Less [-]';
          } else {
            moreContainerElement.style.display = 'none';
            moreLinkElement.innerHTML = 'More [+]';
          }
        }, false);
    }(window.document));
    </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-32397161-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </body>
</html>
